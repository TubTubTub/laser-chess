import pygame
import moderngl
from typing import Protocol, Optional
from data.constants import ShaderType

class SMProtocol(Protocol):
    def load_shader(self, shader_type: ShaderType, **kwargs) -> None: ...
    def clear_shaders(self) -> None: ...
    def create_vao(self, shader_type: ShaderType) -> None: ...
    def create_framebuffer(self, shader_type: ShaderType, size: Optional[tuple[int]]=None, filter: Optional[int]=moderngl.NEAREST) -> None: ...
    def render_to_fbo(self, shader_type: ShaderType, texture: moderngl.Texture, output_fbo: Optional[moderngl.Framebuffer] = None, program_type: Optional[ShaderType] = None, use_image: Optional[bool] = True, **kwargs) -> None: ...
    def apply_shader(self, shader_type: ShaderType, **kwargs) -> None: ...
    def remove_shader(self, shader_type: ShaderType) -> None: ...
    def render_output(self, texture: moderngl.Texture) -> None: ...
    def get_fbo_texture(self, shader_type: ShaderType) -> moderngl.Texture: ...
    def calibrate_pygame_surface(self, pygame_surface: pygame.Surface) -> moderngl.Texture: ...
    def draw(self, surface: pygame.Surface, arguments: dict) -> None: ...
    def __del__(self) -> None: ...
    def cleanup(self) -> None: ...
    def handle_resize(self, new_screen_size: tuple[int]) -> None: ...
    
    _ctx: moderngl.Context
    _screen_size: tuple[int]
    _opengl_buffer: moderngl.Buffer
    _pygame_buffer: moderngl.Buffer
    _shader_stack: list[ShaderType]

    _vert_shaders: dict
    _frag_shaders: dict
    _programs: dict
    _vaos: dict
    _textures: dict
    _shader_passes: dict
    framebuffers: dict